
from ROOT import TH1F, TFile, TChain, TCanvas, gROOT, gStyle, TLegend
import ROOT
import sys
import math
import os

gROOT.SetBatch(True)
gStyle.SetOptStat(0)

from optparse import OptionParser
parser = OptionParser()

parser.add_option("-y", "--year", dest="Year", default="",type='str',
                     help="Specify which year %s, 2017 or 2018?" )
parser.add_option("-c", "--channel", dest="channel", default="Mu",type='str',
                     help="Specify which channel Mu or Ele? default is Mu" )

(options, args) = parser.parse_args()


chan=options.channel
year=options.Year

#chan="Mu"
#year="%s"
#ALDAS for not smeared and LPCTOP for smeared
#tree=TChain("AnalysisTree")
#tree.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/GJets_HT100To200_%s_AnalysisNtuple.root"%(year,year))
#tree.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/GJets_HT200To400_%s_AnalysisNtuple.root"%(year,year))
#tree.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/GJets_HT400To600_%s_AnalysisNtuple.root"%(year,year))
#tree.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/GJets_HT40To100_%s_AnalysisNtuple.root"%(year,year))
#tree.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/GJets_HT600ToInf_%s_AnalysisNtuple.root"%(year,year))
#tree.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt15to20_Mu_%s_AnalysisNtuple.root"%(year,year))

tree11=TChain("AnalysisTree")
tree21=TChain("AnalysisTree")
tree31=TChain("AnalysisTree")
tree41=TChain("AnalysisTree")
tree51=TChain("AnalysisTree")
tree61=TChain("AnalysisTree")
tree71=TChain("AnalysisTree")
tree81=TChain("AnalysisTree")
tree91=TChain("AnalysisTree")
tree101=TChain("AnalysisTree")
tree111=TChain("AnalysisTree")
tree11.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt20to30_Mu_%s_AnalysisNtuple.root"%(year,year))
tree31.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt50to80_Mu_%s_AnalysisNtuple.root"%(year,year))
tree41.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt80to120_Mu_%s_AnalysisNtuple.root"%(year,year))
tree51.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt120to170_Mu_%s_AnalysisNtuple.root"%(year,year))
tree61.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt170to300_Mu_%s_AnalysisNtuple.root"%(year,year))
tree71.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt300to470_Mu_%s_AnalysisNtuple.root"%(year,year))
tree81.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt470to600_Mu_%s_AnalysisNtuple.root"%(year,year))
tree91.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt600to800_Mu_%s_AnalysisNtuple.root"%(year,year))
tree101.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt800to1000_Mu_%s_AnalysisNtuple.root"%(year,year))
tree111.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/%s/QCD_Pt1000toInf_Mu_%s_AnalysisNtuple.root"%(year,year))

#tree1=TChain("AnalysisTree")

#tree1.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_GJets_HT100To200_%s_AnalysisNtuple.root"%(year,year))
#tree1.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_GJets_HT200To400_%s_AnalysisNtuple.root"%(year,year))
#tree1.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_GJets_HT400To600_%s_AnalysisNtuple.root"%(year,year))
#tree1.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_GJets_HT40To100_%s_AnalysisNtuple.root"%(year,year))
#tree1.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_GJets_HT600ToInf_%s_AnalysisNtuple.root"%(year,year))
#tree1.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt15to20_Mu_%s_AnalysisNtuple.root"%(year,year))

tree12=TChain("AnalysisTree")
tree22=TChain("AnalysisTree")
tree32=TChain("AnalysisTree")
tree42=TChain("AnalysisTree")
tree52=TChain("AnalysisTree")
tree62=TChain("AnalysisTree")
tree72=TChain("AnalysisTree")
tree82=TChain("AnalysisTree")
tree92=TChain("AnalysisTree")
tree102=TChain("AnalysisTree")
tree112=TChain("AnalysisTree")
tree12.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt20to30_Mu_%s_AnalysisNtuple.root"%(year,year))
tree22.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt30to50_Mu_%s_AnalysisNtuple.root"%(year,year))
tree32.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt50to80_Mu_%s_AnalysisNtuple.root"%(year,year))
tree42.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt80to120_Mu_%s_AnalysisNtuple.root"%(year,year))
tree52.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt120to170_Mu_%s_AnalysisNtuple.root"%(year,year))
tree62.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt170to300_Mu_%s_AnalysisNtuple.root"%(year,year))
tree72.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt300to470_Mu_%s_AnalysisNtuple.root"%(year,year))
tree82.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt470to600_Mu_%s_AnalysisNtuple.root"%(year,year))
tree92.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt600to800_Mu_%s_AnalysisNtuple.root"%(year,year))
tree102.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt800to1000_Mu_%s_AnalysisNtuple.root"%(year,year))
tree112.Add("root://cmseos.fnal.gov://store/user/aldas/TTGamma_FullRun2/AnalysisNtuples_Dec2020/QCD_controlRegion/%s/QCDcr_QCD_Pt1000toInf_Mu_%s_AnalysisNtuple.root"%(year,year))



h11=TH1F("h11","pt11",10,0,10)
h21=TH1F("h21","pt21",10,0,10)
h31=TH1F("h31","pt31",10,0,10)
h31.GetXaxis().SetTitle("nJet")
h31.SetLineColor(1)
h41=TH1F("h41","pt41",10,0,10)
h41.SetLineColor(2)
h51=TH1F("h51","pt51",10,0,10)
h51.SetLineColor(3)
h61=TH1F("h61","pt61",10,0,10)
h61.SetLineColor(4)
h71=TH1F("h71","pt71",10,0,10)
h71.SetLineColor(5)
h81=TH1F("h81","pt81",10,0,10)
h81.SetLineColor(6)
h91=TH1F("h91","pt91",10,0,10)
h91.SetLineColor(7)
h101=TH1F("h101","pt101",10,0,10)
h101.SetLineColor(8)
h111=TH1F("h111","pt111",10,0,10)
h111.SetLineColor(9)

h31.SetLineWidth(3)
h41.SetLineWidth(3)
h51.SetLineWidth(3)
h61.SetLineWidth(3)
h71.SetLineWidth(3)
h81.SetLineWidth(3)
h91.SetLineWidth(3)
h101.SetLineWidth(3)
h111.SetLineWidth(3)

tree11.Draw("nJet >> h11","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree21.Draw("nJet >> h21","(passPresel_Mu && nBJet==0 && nPho==0 && nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree31.Draw("nJet >> h31","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree41.Draw("nJet >> h41","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree51.Draw("nJet >> h51","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree61.Draw("nJet >> h61","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree71.Draw("nJet >> h71","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree81.Draw("nJet >> h81","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree91.Draw("nJet >> h91","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree101.Draw("nJet >> h101","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree111.Draw("nJet >> h111","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")


h12=TH1F("h12","pt21",10,0,10)
h22=TH1F("h22","pt22",10,0,10)
h32=TH1F("h32","pt32",10,0,10)
h32.GetXaxis().SetTitle("nJet")
h32.SetLineColor(1)
h32.SetLineWidth(3)
h42=TH1F("h42","pt42",10,0,10)
h42.SetLineColor(2)
h42.SetLineWidth(3)
h52=TH1F("h52","pt52",10,0,10)
h52.SetLineColor(3)
h52.SetLineWidth(3)
h62=TH1F("h62","pt62",10,0,10)
h62.SetLineColor(4)
h62.SetLineWidth(3)
h72=TH1F("h72","pt72",10,0,10)
h72.SetLineColor(5)
h72.SetLineWidth(3)
h82=TH1F("h82","pt82",10,0,10)
h82.SetLineColor(6)
h82.SetLineWidth(3)
h92=TH1F("h92","pt92",10,0,10)
h92.SetLineColor(7)
h92.SetLineWidth(3)
h102=TH1F("h102","pt102",10,0,10)
h102.SetLineWidth(3)
h102.SetLineColor(8)
h112=TH1F("h112","pt112",10,0,10)
h112.SetLineColor(9)
h112.SetLineWidth(3)
tree12.Draw("nJet >> h12","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree22.Draw("nJet >> h22","(passPresel_Mu && nBJet==0 && nPho==0 && nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree32.Draw("nJet >> h32","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree42.Draw("nJet >> h42","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree52.Draw("nJet >> h52","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree62.Draw("nJet >> h62","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree72.Draw("nJet >> h72","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree82.Draw("nJet >> h82","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree92.Draw("nJet >> h92","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree102.Draw("nJet >> h102","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
tree112.Draw("nJet >> h112","(passPresel_Mu && nBJet>=1 && nPho==0 &&  nLoosePho==0)*evtWeight*PUweight*muEffWeight*btagWeight_1a*prefireSF")
#h12.Scale(1/h12.Integral())
#h22.Scale(1/h22.Integral())
h32.Scale(1/h32.Integral())
h42.Scale(1/h42.Integral())
h52.Scale(1/h52.Integral())
h62.Scale(1/h62.Integral())
h72.Scale(1/h72.Integral())
h82.Scale(1/h82.Integral())
h92.Scale(1/h92.Integral())
h102.Scale(1/h102.Integral())
h112.Scale(1/h112.Integral())

#h11.Scale(1/h11.Integral())
#h21.Scale(1/h21.Integral())
h31.Scale(1/h31.Integral())
h41.Scale(1/h41.Integral())
h51.Scale(1/h51.Integral())
h61.Scale(1/h61.Integral())
h71.Scale(1/h71.Integral())
h81.Scale(1/h81.Integral())
h91.Scale(1/h91.Integral())
h101.Scale(1/h101.Integral())
h111.Scale(1/h111.Integral())
C1=TCanvas("C1","nJet Distribution",900,800)
C1.Divide(1,2)
C1.cd(1)
legend=TLegend(0.5,0.7,0.9,0.9)
legend.AddEntry(h31,"Pt_50-80","l")
legend.AddEntry(h41,"Pt_80-120","l")
legend.AddEntry(h51,"Pt_120-170","l")
legend.AddEntry(h61,"Pt_170-300","l")
legend.AddEntry(h71,"Pt_300-470","l")
legend.AddEntry(h81,"Pt_470-600","l")
legend.AddEntry(h91,"Pt_600-800","l")
legend.AddEntry(h101,"Pt_800-1000","l")
legend.AddEntry(h111,"Pt_1000-Inf","l")
#h11.Draw("hist")
#h21.Draw("hist same")
h31.Draw("hist same")
h41.Draw("hist same")
h51.Draw("hist same")
h61.Draw("hist same")
h71.Draw("hist same")
h81.Draw("hist same")
h91.Draw("hist same")
h101.Draw("hist same")
h111.Draw("hist same")
legend.Draw()
C1.cd(2)
legend2=TLegend(0.5,0.7,0.9,0.9)
legend2.AddEntry(h32,"Pt_50-80","l")
legend2.AddEntry(h42,"Pt_80-120","l")
legend2.AddEntry(h52,"Pt_120-170","l")
legend2.AddEntry(h62,"Pt_170-300","l")
legend2.AddEntry(h72,"Pt_300-470","l")
legend2.AddEntry(h82,"Pt_470-600","l")
legend2.AddEntry(h92,"Pt_600-800","l")
legend2.AddEntry(h102,"Pt_800-1000","l")
legend2.AddEntry(h112,"Pt_1000-Inf","l")
#h12.Draw("hist")
#h22.Draw("hist same")
h32.Draw("hist same")
h42.Draw("hist same")
h52.Draw("hist same")
h62.Draw("hist same")
h72.Draw("hist same")
h82.Draw("hist same")
h92.Draw("hist same")
h102.Draw("hist same")
h112.Draw("hist same")
legend2.Draw()
C1.SaveAs("njet.pdf")
